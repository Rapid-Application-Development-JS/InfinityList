!function(t,i){if("function"==typeof define&&define.amd)define("radjs-infinitelist",function(){t.RADJS_InfiniteList=i();return t.RADJS_InfiniteList});else if("object"==typeof module&&module.exports){t.RADJS_InfiniteList=i();module.exports=t.RADJS_InfiniteList}else t.RADJS_InfiniteList=i()}(this,function(){"use strict";function t(t,i,e){return i in t?t[i]:e}function i(t,i,e){t[i]=e}function e(t,i){this.index=t;this.item=i;e.prototype={index:-1,item:void 0,position:0,visible:!0}}function n(t,i,e){if(t instanceof Element==!1)throw"Container is not an HTML element";if(null===t.firstElementChild)throw"Object's first child element is empty";if(!i||"function"!=typeof i.getCount||"function"!=typeof i.getItem)throw"Assigned adapter has no support of `getCount` and `getItem` methods";e=(e+"").toLowerCase();if(-1===["h","v","horizontal","vertical"].indexOf(e))throw"Wrong scroll direction ["+e+"]";this.adapter=i;this.elContainer=t;this.elWrapper=t.firstElementChild;this.isVertical="vertical"===e||"v"===e;this.items=[];this.itemsInvisible=[];this.requestAnimationFrameStep=this.requestAnimationFrameStep.bind(this);this.onScroll=this.onScroll.bind(this);this.refresh=this.refresh.bind(this);t.addEventListener("scroll",this.onScroll,!1);window.addEventListener("resize",this.refresh,!1);this.destroy=function(){t.removeEventListener("scroll",this.onScroll);window.removeEventListener("resize",this.refresh);this.state.inAnimation=!1;window.cancelAnimationFrame(this.requestAnimationFrameID);this.elWrapper.innerHTML="";this.adapter=null;this.elContainer=null;this.elWrapper=null;this.items=null;this.itemsInvisible=null;delete this.requestAnimationFrameStep;delete this.onScroll;delete this.refresh};this.state={};this.state.inAnimation=!1;this.state.itemSize=0;this.state.containerSize=0;this.state.lastIndex=-1;this.state.containerPadding=0;this.refresh(!0)}!function(t){t.Date.now||(t.Date.now=function(){return+new Date})}(window);!function(t){t.performance||(t.performance={});t.performance.now&&(t.performance.now=performance.webkitNow||performance.mozNow||performance.msNow||performance.oNow||function(){return Date.now()})}(window);!function(t){for(var i=0,e=["webkit","moz","ms","o"],n=0;n<e.length&&!t.requestAnimationFrame;++n){t.requestAnimationFrame=t[e[n]+"RequestAnimationFrame"];t.cancelAnimationFrame=t[e[n]+"CancelAnimationFrame"]||t[e[n]+"CancelRequestAnimationFrame"]}t.requestAnimationFrame||(t.requestAnimationFrame=function(e){var n=Date.now(),s=Math.max(0,16-(n-i)),a=t.setTimeout(function(){e(n+s)},s);i=n+s;return a});t.cancelAnimationFrame||(t.cancelAnimationFrame=function(t){clearTimeout(t)})}(window);n.prototype={isVertical:void 0,onScroll:function(){window.cancelAnimationFrame(this.requestAnimationFrameID);this.state.inAnimation=!1;this.requestAnimationFrameID=window.requestAnimationFrame(this.requestAnimationFrameStep)},requestAnimationFrameStep:function(){var i=t(this.elWrapper.getBoundingClientRect(),this.isVertical?"top":"left");if(this.state.containerPadding!==i){this.fillList(this.state.containerPadding,i);this.state.containerPadding=i}this.state.inAnimation&&(this.requestAnimationFrameID=window.requestAnimationFrame(this.requestAnimationFrameStep))},fillList:function(t,i){var e,n,s,a,o,r=this.adapter.getCount();for(e=0,n=this.items.length;n>e;e+=1){s=this.items[e];if(s.visible){if(s.position+this.state.itemSize+i<0){s.visible=!1;this.itemsInvisible.push(s)}if(s.position+i>this.state.containerSize){s.visible=!1;this.itemsInvisible.push(s);this.state.lastIndex>=s.index&&(this.state.lastIndex=s.index-1)}}}for(e=0,n=this.items.length;n>e;e+=1){s=this.items[e];if(s.visible){(void 0===a||s.index<a)&&(a=s.index);(void 0===o||s.index>o)&&(o=s.index)}}void 0===a&&void 0===o&&(this.state.lastIndex=Math.min(Math.floor(Math.abs(-i/this.state.itemSize)),r)||-1);for(;this.state.lastIndex<r-1&&this.state.lastIndex*this.state.itemSize+i<this.state.containerSize;){this.state.lastIndex+=1;this.applyItem(this.state.lastIndex)}if("number"==typeof a)for(;a>0&&a*this.state.itemSize+i>0;){a-=1;this.applyItem(a)}this.itemsInvisible.forEach(this.hideItem,this)},hideItem:function(t){i(t.item.style,this.isVertical?"left":"top","200%")},getItemSize:function(){var i,e;e=this.adapter.getItem(0,null);this.elWrapper.appendChild(e);i=t(e.getBoundingClientRect(),this.isVertical?"height":"width");this.elWrapper.removeChild(e);return i},setItemPosition:function(t){i(t.item.style,this.isVertical?"top":"left",t.position+"px");i(t.item.style,this.isVertical?"left":"top",0)},createNewItemHolder:function(t){var i,n=this.adapter.getItem(t,null);this.elWrapper.appendChild(n);i=new e(t,n);this.items.push(i);return i},applyItem:function(t){var i=this.itemsInvisible.pop()||this.createNewItemHolder(t);i.position=t*this.state.itemSize;i.index=t;i.visible=!0;this.adapter.getItem(i.index,i.item);this.setItemPosition(i)},refresh:function(e){var n=e?0:150;clearTimeout(this.refreshID);this.refreshID=setTimeout(function(){window.cancelAnimationFrame(this.requestAnimationFrameID);this.state.inAnimation=!1;this.state.containerPadding=t(this.elWrapper.getBoundingClientRect(),this.isVertical?"top":"left");this.state.itemSize=this.getItemSize();this.state.containerSize=this.elContainer.offsetHeight;i(this.elWrapper.style,this.isVertical?"height":"width",this.state.itemSize*this.adapter.getCount()+"px");for(var e=0,n=this.items.length;n>e;e+=1)this.items[e].position=this.items[e].index*this.state.itemSize;this.fillList(this.state.containerPadding,this.state.containerPadding)}.bind(this),n)}};return n});
//# sourceMappingURL=radjs-infinitelist.min.js.map